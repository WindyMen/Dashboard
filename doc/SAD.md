## 软件架构文档：青年短租    

| 版本    | 日期    | 描述                   | 作者    |    
|:----   |:----    |:----------------       |:------      
|草案    | 2018年5月25日 | 由架构问题、解决方案说明、逻辑视图、物理视图四部分组成  | 15331071    

#### 架构设计    
前端架构基于微信小程序，后端采用基于diango的REST的diango-rest-framework框架，数据库是使用mysql存取数据。    

架构图：
![架构图](架构图.png)

#### 解决方案    
1.问题：如何获取用户当前所在城市
  
  解决方法：微信小程序接口只提供了获取当前用户所在位置的坐标，因此使用了腾讯地图提供的接口，以坐标为输入，然后就能从输出中获取用户所在的城市了。


2.问题：如何确定用户身份的唯一性
  
  解决方法：我们可以在后台自动生成一个唯一的id来标记用户的身份。但是由于我们采用微信小程序来实现，因此可以采用微信官方提供的openid来标记用户身份。我们在用户首次登录的时候，向微信官方发出请求获取用户的openid，然后保存在数据库中。之后用户的每一次登录，我们也请求一次openid，然后返回给前端，因此用户每一次的操作都可以使用openid来验证了。


3.问题：图片的上传和下载问题

  解决方法：由于无知，我们一开始采用了wx.request接口来进行操作。但图片的上传应该调用微信小程序的api——uploadFile来解决。最后整体的解决方案如下：用户上传图片，后台保存在服务器中。当用户请求图片时，后台返回一个图片地址，前端得到地址后，重新发出请求向服务器获取图片.
  
  缺陷：实际上，涉及到类似于图片这种文件的访问，我们需要另外搭建一个静态资源服务器，减轻当前服务器的压力。但由于种种原因，我们只能将两个服务器合二为一，这一点做得并不完善。


#### 逻辑视图    
![逻辑视图](逻辑视图.png)


#### 物理视图    
![物理视图](物理视图.png)

